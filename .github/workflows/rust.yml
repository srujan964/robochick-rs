---
env:
  CARGO_TERM_COLOR: always
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Initalize env file
      run: |
        touch .env
        echo TWITCH_CLIENT_ID="client-id" >> .env
        echo TWITCH_EVENTSUB_SUBSCRIPTION_SECRET="chickencoop" >> .env 
        echo TWITCH_CHANNEL_ID="example_channel_id" >> .env
        echo SE_API_HOST="http://localhost:3000/streamelements/" >> .env
        echo AWS_PARAMETER_STORE_HOST="http://localhost" >> .env
    - name: Build
      run: cargo build
    - name: Run tests
      run: cargo test
      env:
        TWITCH_CLIENT_SECRET: ${{ secrets.TWITCH_CLIENT_SECRET }}
        SE_JWT: ${{ secrets.SE_JWT }}
        AWS_SESSION_TOKEN: ${{ secrets.AWS_SESSION_TOKEN }}

name: Rust
'on':
  pull_request:
    branches: [ "main" ]
  push:
    branches: [ "main" ]
